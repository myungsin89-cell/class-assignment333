{
    "algorithm_info": {
        "version": "V7.2 (Tiered Penalty System)",
        "description": "계층적 벌점(Tiered Penalty) 시스템을 적용하여 인원 균형과 분산 목표를 동시에 달성하는 알고리즘",
        "core_strategy": "Tiered Greedy (계층화된 벌점 우선순위 기반 할당)"
    },
    "phases": [
        {
            "step": 1,
            "name": "데이터 정규화 (Normalization)",
            "logic": "성별 입력을 'M' 또는 'F'로 표준화하고, 동명이인 및 이름 유사성(성 제외 이름 동일) 분석을 위해 데이터를 전처리합니다."
        },
        {
            "step": 2,
            "name": "고정 대상자 우선 배정 (Fixed Student Assignment)",
            "logic": [
                {
                    "target": "특수교육대상자 (is_special_class)",
                    "method": "전체 반에 대해 라운드 로빈(순차) 방식으로 균등하게 분산 배치합니다."
                },
                {
                    "target": "결합 그룹 (BIND)",
                    "method": "그룹원들을 '가중치 적용 인원'이 가장 적은 반에 함께 배정합니다."
                },
                {
                    "target": "분리 그룹 (SEP)",
                    "method": "그룹원들이 서로 다른 반에 배정되도록 인원이 적은 반부터 하나씩 할당합니다."
                }
            ],
            "note": "이 단계에서 배정된 학생은 '고정(Fixed)' 상태가 되어 이후의 성비 조절 시 이동되지 않습니다."
        },
        {
            "step": 3,
            "name": "일반 학생 카테고리별 지그재그 배정 (General Zigzag)",
            "logic": "학생들을 '기존반_성별' 카테고리로 묶고, 각 카테고리 내에서 '석차' 순으로 정렬합니다.",
            "assignment_rules": [
                "1순위: 특정 성별이 0명인 반이 있다면 해당 반에 우선 배정하여 성별 유령반을 방지합니다.",
                "2순위: 가중치 적용 인원(Effective Size)이 가장 적은 반에 배정하며, 지그재그 순서를 최대한 존중합니다."
            ]
        },
        {
            "step": 4,
            "name": "성비 균형 및 안전장치 (Balancing & Rescue)",
            "logic": [
                {
                    "name": "성비 균형 루프 (Gender Balance)",
                    "method": "고정되지 않은 학생들 간의 스왑(교환)을 통해 모든 반의 남학생 수를 전교 평균 성비에 가깝게 조정합니다."
                },
                {
                    "name": "성별 0명 구조 (Zero-Gender Rescue)",
                    "method": "최종 배정 후에도 성별이 0명인 반이 발견되면, 고정되지 않은 학생을 즉시 이동시켜 최소 1명의 성별 유효성을 확보합니다."
                }
            ]
        },
        {
            "configuration": {
                "weighted_headcount_formula": "가중치 인원 = 실제 인원 + (특수학생 수 * 배려 인원 설정값)",
                "message_logic": {
                    "reduction_0": "인원 쏠림: [1반]과 [2반]의 인원 차이가 [N]명입니다.",
                    "reduction_gt_0": "인원 쏠림: [1반]과 [2반]의 가중치 편차가 [N]명입니다. (특수학생 인원 조정 반영)"
                }
            }
        }
    ],
    "constraints": {
        "lock_logic": "특수학생, 전출예정, BIND/SEP 그룹 학생은 후처리 과정에서 절대 이동되지 않습니다.",
        "transfer_out_logic": "전출예정 학생은 통계에서는 제외되지만, 반 구성 시 마지막에 순차적으로 배치됩니다."
    }
}